# http 1.1使用的认证

1. BASIC认证（基本认证）

2. DIGEST认证（摘要认证）

3. SSL客户端认证

4. FormBase认证（表单认证）

## BASIC认证（基本认证）

1. 客户端向服务器请求资源，该资源需要BASIC认证（基本认证），服务器会返回401 Authorization Require状态码，返回带有WWW-Authenticate首部字段的响应，这个首部字段会告诉客户端认证的方式和request-URI安全域字符串

2. 客户端接受到401状态码，会把用户名和密码用冒号连接，再经过base64转码，放进Authorization首部字段发送给服务器端

3. 服务器接收到Authorization首部字段，会对用户名和密码进行验证，验证通过，返回包含request-URI首部字段的资源，否则返回状态码：401 Authorization Require

缺点：

1. base64转码，但不是加密，安全性不够高，容易被窃取

2. 不够灵活，无法认证注销，职能认证一次

## DIGEST认证（摘要认证）

采用质询/响应的方式认证

1. 客户端向服务器请求资源，服务器会返回401 Authorization Require状态码，返回带有WWW-Authenticate首部字段的响应，这个首部字段会告诉客户端质问响应方式所需要的临时质询码（随机数，nonce）和realm认证方式

2. 客户端接收到带有WWW-Authenticate首部字段的响应，会再次请求服务器，这次请求会带上首部字段Authorization，Authorization字段包含：username，realm，nonce，uri

3. 服务器接收到带有认证信息的请求，会对传来的认证信息进行验证，验证通过后咋返回包含request-URI首部字段的资源，并且在返回的首部字段中有一个Authentication-Info字段中写入认证成功的相关信息

## SSL客户端认证

需要事先将客户端证书分发给客户端，客户端必须安装这个证书

1. 服务器接收到客户端的请求，被请求的资源需要认证，服务器会Certificate Request报文，要求客户提供客户端证书

2. 客户选择要发送的客户端证书后，客户端会把客户端证书以Client Certificate报文形式发送给服务端

3. 服务器获取到了客户端发来的客户端证书，首先会验证客户端证书，验证通过后，会回去客户端证书里的公开密钥，然后开始https加密通信

## FormBase认证（表单认证）

通过服务端的Web应用，将客户端发送过来的ID和密码与之前登陆过的信息做匹配来进行认证

http是无状态协议，之前登陆过的已经认证成功的状态无法通过协议层面保存下来，无法实现状态管理，因此当下一次用户继续访问，无法区分他与其他用户

使用cookie管理session

1. 客户端通过表单提交，把用户ID和密码等登陆信息放入报文的实体部分，使用https通信来传输报文

2. 服务器向客户端发放用以识别客户的Session ID，通过响应报文中的首部字段：set-cookie字段发放，通过验证从客户端发送来的登陆信息进行身份认证，然后把用户的登陆状态和session ID进行绑定后，记录在服务端

3. 客户端接收到session ID后会将它作为cookie保存在本地，下次向服务器发送请求的时候，浏览器会自动发送cookie，然后服务器通过这个值进行验证

